<h1 style="text-align: center;">
  <div>
    <a href="https://insigneo.org/">
    <img src="images/big_logo.svg" alt="PyPeCT2S" width="100%" alt="PyPeCT2S Logo">
    </a>
  </div>
</h1>

<h2 style="text-align: center;">
  Pythonic Paediatric Computed Tomography to Strength
</h2>

<p style="text-align: center;">
  <a href="https://figshare.com/articles/software/PyPeCT2S/26425591">
    <img src="https://img.shields.io/badge/DOI-10.6084/m9.figshare.26425591-brightgreen" alt="DOI">
  </a>
  <a href="https://www.sheffield.ac.uk">
    <img src="https://img.shields.io/badge/-The%20University%20of%20Sheffield-blue.svg?colorA=ffffff&colorB=009fe3&logo=data%3Aimage%2Fpng%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAMAAAAolt3jAAABsFBMVEUAAABmZplVVYBLPHheUYZJPXlSR3pCOnNgWIdoYI9FPnVMQXc0JGM0KmhEOXI0MW8xMW2Ph6yYkrOWj6%2BOiayinLqWkbIcWJkdWJezrsW2sciclrWmoL0cWpkbXJuCfqQVba4Vba2tqsKBgKWXkbGgm7ioo7%2Bln7umobyppcClob0RdrgSd7ikoLuXkbEeeKwieqmYkrKkn7sAneAAn%2BMBnN8Dn%2BIEj9IEkNQEoOMFi88GicwHnuAInuAVaqkVgrEWa6sWiskYj84ek88mk8wmqOInqOIqhrA4qd45qd87kaA8q988q%2BA9qN0%2Fk51Aqd1CqdxCqd1JnqtNnc9OnKVPnItSmsZUmqZVlsFVnYZVns1bst9ds99ftN9isNtitN9joa1msdtnveZqoaRqrNZqvuZsrdZvk2lylWR0nKZ2oJx%2BfKOBf6WEn5eGr3iIr3eduNWfmbifmrifudWim6mjnKmloLymrz2psTuuqb6uqsOwq8C0taG2tqS4tqy4tra6uTC6ui6%2FsCK%2FsCPBvdHDv9LFwtfGwtjOy9rPzdvUlaHmkpb%2B%2FPz%2B%2Fv7%2F%2FPz%2F%2F%2F9OZpcfAAAAM3RSTlMABQYRExUZHyAgJS8xMTFTVFleZmiJkpOTmp2oqba9wsTFxcfO0dPX3OLj5%2Bf19v39%2Fv4kncL4AAAAvElEQVR4AWNgYBIQV9Q20NdRkOBnZGBg4DExTQ9taIzMMDbhA3PdzMqbmyosXaHc4kCvvHy%2FgAIINzElvL%2B%2FvzcoLQ7E5bX1TOhq624P8bDhBnLZTEwye%2Fr7%2BpNNTFgYgMApJreuprY%2BK94RyOGSlEv19XZx9vFPkpViZ1BRZ7WKdq%2Bsto%2B1ZtZQYhAp1FS2iCopDTaX1yoSZmDgkNHrsAuLcOjUleZkAAGxqtbsnJYyUQYoEFIzMlQVBLEA%2FZgsl9iPrB4AAAAASUVORK5CYII%3D" alt="TUoS">
  </a>
  <a href="https://insigneo.org/">
    <img src="https://img.shields.io/badge/-INSIGNEO-red.svg?colorA=ffffff&colorB=cf2020&logo=data%3Aimage%2Fpng%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAMAAAAolt3jAAABC1BMVEUAAAD%2FAAC%2FAADMGhrRFxfSHh7VHBzJGxvTISHKICDMHx%2FOHR3RJCTTIyPOISHPICDMHR3NIyPNICDRISHQHx%2FQHx%2FOHx%2FQISHOICDQICDQHx%2FOHx%2FPISHQISHQICDOICDQISHOICDQICDPISHPICDQISHPICDPICDOHx%2FPISHPISHQISHPICDPISHPISHQICDOICDOICDPHx%2FPICDPICDOICDPICDPICDPICDPHx%2FPICDPICDQICDPICDPHx%2FQISHOICDPICDPICDPICDPICDPHx%2FMISHOICDPICDQICDPICDPISHPHx%2FPICDPICDPICDPICDPICDPICDOICDPHx%2FPICDPICDPICDPICDi8V76AAAAWHRSTlMAAgQKCxESExcYGRocHR8gIyRITVFSU1ZYYWJjZGZnaWxucXV5fH%2BAg4SFjI%2BUlZeYqKuusbK2ubrDxcbHycvMzdHU2Nrb4uLl5%2Bnq6%2Bzt7u%2F09vf7%2FP3%2B%2FHERCQAAAKVJREFUeAEdx%2BVCg2AAhtHHAANDMQRD7ECwO7DDjViM7b3%2FK9n4zr9Dxdk6jjc4s02si46kK7tMLGDuW%2Fq%2FvdxZlt5shh7VWhsGTqWvTVYll0q4PjMyy7VuYHQ7nIL98oVMAey183sI9EtNPpzXfz7BV8aHIpi%2Fe3ch1iuHysYxnFxHTDf1bD7xpMKBxa6Kk6WVKFXPY8BLZTQWMMYOHvK%2FZHcS6AOapR0V%2FpSSVQAAAABJRU5ErkJggg%3D%3D" alt="INSIGNEO">
  </a>
  <a href="https://opensource.org/licenses/GPL-3.0">
    <img src="https://img.shields.io/badge/License-GPL%203.0-blue.svg" alt="License GNU GPL 3.0">
  </a>
  <img alt="GitHub all releases" src="https://img.shields.io/github/downloads/INSIGNEO/PyPeCT2S/total">
    <img alt="GitHub commits since latest release (by date) for a branch" src="https://img.shields.io/github/commits-since/INSIGNEO/PyPeCT2S/latest">
</p>

<div style="text-align: center;" markdown>
[:fontawesome-solid-download: __Download__](https://github.com/INSIGNEO/PyPeCT2S/releases/latest){ .md-button }
[:fontawesome-brands-github: __GitHub__](https://github.com/INSIGNEO/PyPeCT2S){ .md-button }
[:fontawesome-solid-envelope: __Contact__](mailto:GHAllison1@sheffield.ac.uk){ .md-button }
[:material-license: __License__](https://github.com/INSIGNEO/PyPeCT2S/blob/main/LICENSE){ .md-button }
[:octicons-cross-reference-16: __DOI/Cite__](https://doi.org/10.6084/m9.figshare.26425591){ .md-button }
</div>

## Introduction

This work uses techniques and tools developed by the [INSIGNEO Institute](https://www.sheffield.ac.uk/insigneo) for the [CT2S](https://ct2s.insigneo.org/ct2s/) pipeline.

The goal of this work is to automate the [CT2S](https://ct2s.insigneo.org/ct2s/) pipeline steps, to use them in a modern setting in a repeatable and
user-friendly manner; with high adaptability and extensibility.

Use of this tool has resulted in pipeline time reductions of up to 70 %.

Scripts, methods, and work contained in this repository have been heavily based on works by 
[Dr Xinshan Li](https://scholar.google.co.uk/citations?user=T3t8XdcAAAAJ&hl=en) and 
[Dr Zainab Altai](https://scholar.google.com/citations?user=VaL--SsAAAAJ&hl=en).

Specific works of importance to this repository are: <ref>[1](#ref1), [2](#ref2), [3](#ref3), [4](#ref4)</ref>

## Contact

If you have any questions, please contact the authors:

George H. Allison ([Email](mailto:GHAllison1@sheffield.ac.uk) | [LinkedIn](https://www.linkedin.com/in/george-h-allison/)), 
Dr Xinshan Li ([Email](mailto:xinshan.li@sheffield.ac.uk))

If you have any additional queries regarding the CT2S pipeline, please contact the 
[INSIGNEO Institute](https://www.sheffield.ac.uk/insigneo).

## Disclaimer

This software has been designed for research purposes only and has not been reviewed or approved by medical device 
regulation bodies.

This software is not to be used alone or in combination, for human beings for one or more of the following specific 
medical purposes:

- diagnosis, prevention, monitoring, prediction, prognosis, treatment or alleviation of disease.
- diagnosis, monitoring, treatment, alleviation of, or compensation for, an injury or disability.
- investigation, replacement or modification of the anatomy or of a physiological or pathological process or
state.
- providing information by means of _in vitro_ examination of specimens derived from the human body, including
organ, blood and tissue donations.

Please note that this software is provided as is and without warranty. The authors are not responsible for any damage.

Please ensure you have the correct permissions to run the software and that you have the correct licenses for the software
you are using.

Please keep in mind the limits of the software this GUI interfaces with, and the limits of the software itself. _We
cannot solve issues that arise from software we do not control._ However, if you think there is an issue with the
GUI, please raise an issue on the repository.


## Feedback and Development

This software is in active development and will likely remain for the next few years. If you have any feedback, 
please raise an issue or open a discussion on the repository.

If you want to include your custom scripts, please raise an issue, open a discussion, or create a pull request 
on the repository. Alternatively, you can contact the authors directly.

Pull requests are welcome, but please ensure you have tested your changes before submitting.

## Project layout

    PyPeCT2S.py                     # The main run file.
    qt_gui.py                       # The main GUI file.
    requirements.txt                # The requirements file for reproducing the environment.
    README.md                       # The project README.
    LICENSE                         # The project license.

    core_libs/                      # The core libraries for the project.
        __init__.py                 # The core library init file.
        ansys_vars.py               # The ANSYS variables file.
        gui_funcs.py                # The GUI functions file.
        gui_vars.py                 # The GUI variables file.
        ldmk_funcs.py               # The landmark functions file.
        mat_vars.py                 # The material variables file.
        stl_checks.py               # The STL checks file.
        texteditredirector.py       # The text edit redirector file.
        waitingspinnerwidget.py     # The waiting spinner widget file.

    fem_libs/                       # The FEM libraries to load for the gui.
        __init__.py                 # init file to find all the FEM scripts on launch.
        A_APDL_4B_fem.py            # ANSYS APDL 4-Point Bending FEM script

    materials_libs/                 # The material libraries to load for the gui.
        __init__.py                 # init file to find all the material scripts on launch.
        Bonemat_cli.py              # Runs the Bonemat CLI from python.

    mesh_libs/                      # The meshing libraries to load for the gui.
        __init__.py                 # init file to find all the meshing scripts on launch.
        A_IA_mesher.py              # ANSYS ICEM CFD and APDL meshing script.

    post_libs/                      # The post-processing libraries to load for the gui.
        __init__.py                 # init file to find all the post-processing scripts on launch.
        A_post.py                   # ANSYS post-processing functionality.

    bonemat/
        ...                         # For placing personal Bonemat CLI executable.   

    docs/
        index.md                    # The documentation homepage.
        ...                         # Other markdown pages, images and other files.

## REFERENCES

<a id='ref1'>1</a>: Altai, Z., Viceconti, M., Offiah, A.C. et al. Investigating the mechanical response of paediatric 
bone under bending and torsion using finite element analysis. Biomechanics and Modeling in Mechanobiology 17, 1001–1009 
(2018). [DOI](https://doi.org/10.1007/s10237-018-1008-9)

<a id='ref2'>2</a>: Altai, Z., Muhammad, Q., Li, X. et al. The effect of boundary and loading conditions on patient 
classification using finite element predicted risk of fracture. Clinical Biomechanics 68, 137–143 
(2019). [DOI](https://doi.org/10.1016/j.clinbiomech.2019.06.004)

<a id='ref3'>3</a>: Li, X., Viceconti, M., Cohen, M.C. et al. Developing CT based computational models of pediatric 
femurs. Journal of Biomechanics 48, 2034–2040 
(2015). [DOI](https://doi.org/10.1016/j.jbiomech.2015.03.027)

<a id='ref4'>4</a>: Viceconti, M., Muhammad, Q., Bhattacharya, P. et al. Are CT-Based Finite Element Model Predictions 
of Femoral Bone Strengthening Clinically Useful? Current Osteoporosis Reports 16, 216–223 
(2018). [DOI](https://doi.org/10.1007/s11914-018-0438-8)