<h1 align="center">
  <div>
    <a href="https://insigneo.org/">
    <img src="icons/big_logo.svg" alt="PyPeCT2S" width="100%" alt="PyPeCT2S Logo">
    </a>
  </div>
</h1>

<h2 align="center">
  Pythonic Paediatric Computed Tomography to Strength
</h2>

<p align="center">
  <a href="https://figshare.com/articles/software/PyPeCT2S/26425591">
    <img src="https://img.shields.io/badge/DOI-10.6084/m9.figshare.26425591-brightgreen" alt="DOI">
  </a>
  <a href="https://www.sheffield.ac.uk">
    <img src="https://img.shields.io/badge/-The%20University%20of%20Sheffield-blue.svg?colorA=ffffff&colorB=009fe3&logo=data%3Aimage%2Fpng%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAMAAAAolt3jAAABsFBMVEUAAABmZplVVYBLPHheUYZJPXlSR3pCOnNgWIdoYI9FPnVMQXc0JGM0KmhEOXI0MW8xMW2Ph6yYkrOWj6%2BOiayinLqWkbIcWJkdWJezrsW2sciclrWmoL0cWpkbXJuCfqQVba4Vba2tqsKBgKWXkbGgm7ioo7%2Bln7umobyppcClob0RdrgSd7ikoLuXkbEeeKwieqmYkrKkn7sAneAAn%2BMBnN8Dn%2BIEj9IEkNQEoOMFi88GicwHnuAInuAVaqkVgrEWa6sWiskYj84ek88mk8wmqOInqOIqhrA4qd45qd87kaA8q988q%2BA9qN0%2Fk51Aqd1CqdxCqd1JnqtNnc9OnKVPnItSmsZUmqZVlsFVnYZVns1bst9ds99ftN9isNtitN9joa1msdtnveZqoaRqrNZqvuZsrdZvk2lylWR0nKZ2oJx%2BfKOBf6WEn5eGr3iIr3eduNWfmbifmrifudWim6mjnKmloLymrz2psTuuqb6uqsOwq8C0taG2tqS4tqy4tra6uTC6ui6%2FsCK%2FsCPBvdHDv9LFwtfGwtjOy9rPzdvUlaHmkpb%2B%2FPz%2B%2Fv7%2F%2FPz%2F%2F%2F9OZpcfAAAAM3RSTlMABQYRExUZHyAgJS8xMTFTVFleZmiJkpOTmp2oqba9wsTFxcfO0dPX3OLj5%2Bf19v39%2Fv4kncL4AAAAvElEQVR4AWNgYBIQV9Q20NdRkOBnZGBg4DExTQ9taIzMMDbhA3PdzMqbmyosXaHc4kCvvHy%2FgAIINzElvL%2B%2FvzcoLQ7E5bX1TOhq624P8bDhBnLZTEwye%2Fr7%2BpNNTFgYgMApJreuprY%2BK94RyOGSlEv19XZx9vFPkpViZ1BRZ7WKdq%2Bsto%2B1ZtZQYhAp1FS2iCopDTaX1yoSZmDgkNHrsAuLcOjUleZkAAGxqtbsnJYyUQYoEFIzMlQVBLEA%2FZgsl9iPrB4AAAAASUVORK5CYII%3D" alt="TUoS">
  </a>
  <a href="https://insigneo.org/">
    <img src="https://img.shields.io/badge/-INSIGNEO-red.svg?colorA=ffffff&colorB=cf2020&logo=data%3Aimage%2Fpng%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAMAAAAolt3jAAABC1BMVEUAAAD%2FAAC%2FAADMGhrRFxfSHh7VHBzJGxvTISHKICDMHx%2FOHR3RJCTTIyPOISHPICDMHR3NIyPNICDRISHQHx%2FQHx%2FOHx%2FQISHOICDQICDQHx%2FOHx%2FPISHQISHQICDOICDQISHOICDQICDPISHPICDQISHPICDPICDOHx%2FPISHPISHQISHPICDPISHPISHQICDOICDOICDPHx%2FPICDPICDOICDPICDPICDPICDPHx%2FPICDPICDQICDPICDPHx%2FQISHOICDPICDPICDPICDPICDPHx%2FMISHOICDPICDQICDPICDPISHPHx%2FPICDPICDPICDPICDPICDPICDOICDPHx%2FPICDPICDPICDPICDi8V76AAAAWHRSTlMAAgQKCxESExcYGRocHR8gIyRITVFSU1ZYYWJjZGZnaWxucXV5fH%2BAg4SFjI%2BUlZeYqKuusbK2ubrDxcbHycvMzdHU2Nrb4uLl5%2Bnq6%2Bzt7u%2F09vf7%2FP3%2B%2FHERCQAAAKVJREFUeAEdx%2BVCg2AAhtHHAANDMQRD7ECwO7DDjViM7b3%2FK9n4zr9Dxdk6jjc4s02si46kK7tMLGDuW%2Fq%2FvdxZlt5shh7VWhsGTqWvTVYll0q4PjMyy7VuYHQ7nIL98oVMAey183sI9EtNPpzXfz7BV8aHIpi%2Fe3ch1iuHysYxnFxHTDf1bD7xpMKBxa6Kk6WVKFXPY8BLZTQWMMYOHvK%2FZHcS6AOapR0V%2FpSSVQAAAABJRU5ErkJggg%3D%3D" alt="INSIGNEO">
  </a>
  <a href="https://opensource.org/licenses/GPL-3.0">
    <img src="https://img.shields.io/badge/License-GPL%203.0-blue.svg" alt="License GNU GPL 3.0">
  </a>
  <img alt="GitHub all releases" src="https://img.shields.io/github/downloads/INSIGNEO/PyPeCT2S/total">
    <img alt="GitHub commits since latest release (by date) for a branch" src="https://img.shields.io/github/commits-since/INSIGNEO/PyPeCT2S/latest">
</p>

<p align="center">
  <a href="https://github.com/INSIGNEO/PyPeCT2S/releases/latest">Download</a> |
  <a href="https://insigneo.github.io/PyPeCT2S/">Documentation</a> |
  <a href="mailto:GHAllison1@sheffield.ac.uk">Contact</a>
</p>

**Authors:** George H Allison<sup>1,2</sup>

**Affiliation:** 
<sup>1</sup> [INSIGNEO Institute, University of Sheffield, United Kingdom](https://www.sheffield.ac.uk/insigneo); 
<sup>2</sup> [School of Mechanical, Aerospace & Civil Engineering, University of Sheffield, United Kingdom](https://www.sheffield.ac.uk/mecheng)

**Contact:** 
GHA ([Email](mailto:GHAllison1@sheffield.ac.uk) | [LinkedIn](https://www.linkedin.com/in/george-h-allison/)), 
Dr X. Li ([Email](mailto:xinshan.li@sheffield.ac.uk))

## INTRODUCTION

This work uses techniques and tools developed by the [INSIGNEO Institute](https://www.sheffield.ac.uk/insigneo) for the [CT2S](https://ct2s.insigneo.org/ct2s/) pipeline.

The goal of this work is to automate the [CT2S](https://ct2s.insigneo.org/ct2s/) pipeline steps, to use them in a modern setting in a repeatable and
user-friendly manner; with high adaptability and extensibility.

Use of this tool has resulted in pipeline time reductions of up to 70 %.

Scripts, methods, and work contained in this repository have been heavily based on works by 
[Dr Xinshan Li](https://scholar.google.co.uk/citations?user=T3t8XdcAAAAJ&hl=en) and 
[Dr Zainab Altai](https://scholar.google.com/citations?user=VaL--SsAAAAJ&hl=en).

Specific works of importance to this repository are: <ref>[1](#ref1), [2](#ref2), [3](#ref3), [4](#ref4)</ref>

If you use this software in your work, please cite the following: [CITATION](CITATION.cff)

Detailed documentation can be found in the project page or in the application itself under the `HELP` 
link at the bottom. [Documentation](https://insigneo.github.io/PyPeCT2S/)

If you find this software useful, please consider starring the repository.


## USAGE

**_Please only run the scripts if you are comfortable running Python scripts._**

It is recommended to use the latest release available under: [Releases](https://github.com/INSIGNEO/PyPeCT2S/releases/latest)

You can run each tab individually, or run the entire pipeline from the start. 
(e.g. You may want to stop after the material assignment step and take that file to your own solving software. This is
possible and just requires you to use the first two tabs.)

Fill in blank fields and press button to run. Information will display in the log window. Repeat for each tab required.

## REQUIREMENTS

>[!IMPORTANT]
> 
><span style="color:red">**An ANSYS install is required to run ANSYS based scripts**</span>
> 
> Make Sure you are connected to a licensing server before running.
>
>ANSYS scripts require a minimum ANSYS version (2021R2) to function correctly. 2023R2 and above is recommended, and the 
> systems have been tested on 2021R2 up.

If you are looking to use automatic Bonemat-based material assignment, you will need to have the **_rolling_** version
of [Bonemat](https://ior-bic.github.io/software/bonemat/) available on your system and copy the `BonematCLI.exe` in 
to the Bonemat folder. We will not distribute a copy of Bonemat with is software.

Please keep in mind the limits of the software this GUI interfaces with. _We cannot solve issues that arise for errors 
in software we do not control._ However, if you think there is an issue with the GUI, please raise an issue on the repo.

### Python Requirements

- [See requirements file](requirements.txt)

- Set up an environment as follows:
  - `pip install -r requirements.txt`

### File / Model / Input Requirements

You can start the process at any step by jumping to that tab.

If you wish to start fresh you require the following files:
- DICOM image scans contained in a `*.VTK` file.
- Segmented 3D `*.STL` model of the bone. (_**It is important you check the quality of segmentation, meshing will fail 
if there are external floating elements in the model.**_)
- Configuration file for material application, based on the specific CT scanner used.

## CONTACT

Batch and pool processing are currently unavailable in the public release.

Sideways and STANCE are currently unavailable in the public release.

If you are interested in any of these features, please contact the authors.

GHA ([Email](mailto:GHAllison1@sheffield.ac.uk) | [LinkedIn](https://www.linkedin.com/in/george-h-allison/)), 
Dr X. Li ([Email](mailto:xinshan.li@sheffield.ac.uk))

## DISCLAIMER

This software has been designed for research purposes only and has not been reviewed or approved by medical device 
regulation bodies.

This software is not to be used alone or in combination, for human beings for one or more of the following specific 
medical purposes:
- diagnosis, prevention, monitoring, prediction, prognosis, treatment or alleviation of disease.
- diagnosis, monitoring, treatment, alleviation of, or compensation for, an injury or disability.
- investigation, replacement or modification of the anatomy or of a physiological or pathological process or
state.
- providing information by means of _in vitro_ examination of specimens derived from the human body, including
organ, blood and tissue donations.

## FEEDBACK AND DEVELOPMENT

This software is in active development and will likely remain for the next few years. If you have any feedback, 
please raise an issue or open a discussion on the repository.

If you want to include your custom scripts, please raise an issue, open a discussion, or create a pull request 
on the repository. Alternatively, you can contact the authors directly.

Pull requests are welcome, but please ensure you have tested your changes before submitting.

## REFERENCES

<a id='ref1'>1</a>: Altai, Z., Viceconti, M., Offiah, A.C. et al. Investigating the mechanical response of paediatric 
bone under bending and torsion using finite element analysis. Biomechanics and Modeling in Mechanobiology 17, 1001–1009 
(2018). [DOI](https://doi.org/10.1007/s10237-018-1008-9)

<a id='ref2'>2</a>: Altai, Z., Muhammad, Q., Li, X. et al. The effect of boundary and loading conditions on patient 
classification using finite element predicted risk of fracture. Clinical Biomechanics 68, 137–143 
(2019). [DOI](https://doi.org/10.1016/j.clinbiomech.2019.06.004)

<a id='ref3'>3</a>: Li, X., Viceconti, M., Cohen, M.C. et al. Developing CT based computational models of pediatric 
femurs. Journal of Biomechanics 48, 2034–2040 
(2015). [DOI](https://doi.org/10.1016/j.jbiomech.2015.03.027)

<a id='ref4'>4</a>: Viceconti, M., Muhammad, Q., Bhattacharya, P. et al. Are CT-Based Finite Element Model Predictions 
of Femoral Bone Strengthening Clinically Useful? Current Osteoporosis Reports 16, 216–223 
(2018). [DOI](https://doi.org/10.1007/s11914-018-0438-8)
